// ColorBox v1.3.20.1 - jQuery lightbox plugin
// (c) 2012 Jack Moore - jacklmoore.com
// License: http://www.opensource.org/licenses/mit-license.php
// modified by roden (c) 2012 for use only with www.shuvalovo-ozerki.ru
(function(a,b,c){var d={transition:"elastic",speed:250,width:false,initialWidth:"560",innerWidth:false,maxWidth:false,height:false,initialHeight:"420",innerHeight:false,maxHeight:false,scalePhotos:true,scrolling:true,inline:false,html:false,iframe:false,fastIframe:true,photo:false,href:false,title:false,rel:false,opacity:0.33,preloading:true,current:false,previous:"Следующий этаж",next:"Предыдущий этаж",close:"Закрыть",xhrError:"This content failed to load.",imgError:"Ошибка",ptitle:"Показать план следующего этажа",ntitle:"Показать план предыдущего этажа",open:false,returnFocus:false,reposition:true,loop:false,slideshow:false,slideshowAuto:true,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",onOpen:false,onLoad:false,onComplete:false,onCleanup:false,onClosed:false,overlayClose:true,escKey:true,arrowKey:false,top:105,bottom:false,left:false,right:false,fixed:false,data:undefined},e="colorbox",f="cbox",g=f+"Element",h=f+"_open",i=f+"_load",j=f+"_complete",k=f+"_cleanup",l=f+"_closed",m=f+"_purge",n=!a.support.opacity&&!a.support.style,o=n&&!c.XMLHttpRequest,p=f+"_IE6",q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X="div",Y;function Z(c,d,e){var g=b.createElement(c);if(d)g.id=f+d;if(e)g.style.cssText=e;return a(g)}function aa(a){var b=y.length,c=(Q+a)%b;return c<0?b+c:c}function ba(a,b){return Math.round((/%/.test(a)?(b==="x"?da():ea())/100:1)*parseInt(a,10))}function ca(a){return K.photo||/\.(gif|png|jp(e|g|eg)|bmp|ico)((#|\?).*)?$/i.test(a)}function da(){return c.innerWidth||z.width()}function ea(){return c.innerHeight||z.height()}function fa(){var b,c=a.data(P,e);if(c==null){K=a.extend({},d);if(console&&console.log)console.log("Error: cboxElement missing settings object")}else K=a.extend({},c);for(b in K)if(a.isFunction(K[b])&&b.slice(0,2)!=="on")K[b]=K[b].call(P);K.rel=K.rel||P.rel||"nofollow";K.href=K.href||a(P).attr("href");K.title=K.title||P.title;if(typeof K.href==="string")K.href=a.trim(K.href)}function ga(b,c){a.event.trigger(b);if(c)c.call(P)}function ha(){var a,b=f+"Slideshow_",c="click."+f,d,e,g;if(K.slideshow&&y[1]){d=function(){F.text(K.slideshowStop).unbind(c).bind(j,function(){if(K.loop||y[Q+1])a=setTimeout(W.next,K.slideshowSpeed)}).bind(i,function(){clearTimeout(a)}).one(c+" "+k,e);r.removeClass(b+"off").addClass(b+"on");a=setTimeout(W.next,K.slideshowSpeed)};e=function(){clearTimeout(a);F.text(K.slideshowStart).unbind([j,i,k,c].join(" ")).one(c,function(){W.next();d()});r.removeClass(b+"on").addClass(b+"off")};if(K.slideshowAuto)d();else e()}else r.removeClass(b+"off "+b+"on")}function ia(b){if(!U){P=b;fa();y=a(P);Q=0;if(K.rel!=="nofollow"){y=a("."+g).filter(function(){var b=a.data(this,e),c;if(b)c=b.rel||this.rel;return c===K.rel});Q=y.index(P);if(Q===-1){y=y.add(P);Q=y.length-1}}if(!S){S=T=true;r.show();if(K.returnFocus)a(P).blur().one(l,function(){a(this).focus()});q.css({opacity:+K.opacity,cursor:K.overlayClose?"pointer":"auto"}).show();K.w=ba(K.initialWidth,"x");K.h=ba(K.initialHeight,"y");W.position();if(o)z.bind("resize."+p+" scroll."+p,function(){q.css({width:da(),height:ea(),top:z.scrollTop(),left:z.scrollLeft()})}).trigger("resize."+p);ga(h,K.onOpen);J.add(D).hide();I.html(K.close).show()}W.load(true)}}function ja(){if(!r&&b.body){Y=false;z=a(c);r=Z(X).attr({id:e,"class":n?f+(o?"IE6":"IE"):""}).hide();q=Z(X,"Overlay",o?"position:absolute":"").hide();C=Z(X,"LoadingOverlay").add(Z(X,"LoadingGraphic"));s=Z(X,"Wrapper");t=Z(X,"Content").append(A=Z(X,"LoadedContent","width:0; height:0; overflow:hidden"),D=Z(X,"Title"),E=Z(X,"Current"),G=Z(X,"Next"),H=Z(X,"Previous"),F=Z(X,"Slideshow").bind(h,ha),I=Z(X,"Close"),$leftnav=Z(X,"LeftNav"),$rightnav=Z(X,"RightNav"));s.append(Z(X).append(Z(X,"TopLeft"),u=Z(X,"TopCenter"),Z(X,"TopRight")),Z(X,false,"clear:left").append(v=Z(X,"MiddleLeft"),t,w=Z(X,"MiddleRight")),Z(X,false,"clear:left").append(Z(X,"BottomLeft"),x=Z(X,"BottomCenter"),Z(X,"BottomRight"))).find("div div").css({float:"left"});B=Z(X,false,"position:absolute; width:9999px; visibility:hidden; display:none");J=G.add(H).add(E).add(F);a(b.body).append(q,r.append(s,B))}}function ka(){if(r){if(!Y){Y=true;L=u.height()+x.height()+t.outerHeight(true)-t.height();M=v.width()+w.width()+t.outerWidth(true)-t.width();N=A.outerHeight(true);O=A.outerWidth(true);r.css({"padding-bottom":L,"padding-right":M});G.click(function(){W.next()});H.click(function(){W.prev()});I.click(function(){W.close()});q.click(function(){if(K.overlayClose)W.close()});$leftnav.click(function(){W.next()});$rightnav.click(function(){W.prev()});a(b).bind("keydown."+f,function(a){var b=a.keyCode;if(S&&K.escKey&&b===27){a.preventDefault();W.close()}if(S&&K.arrowKey&&y[1])if(b===37){a.preventDefault();H.click()}else if(b===39){a.preventDefault();G.click()}});a("."+g,b).live("click",function(a){if(!(a.which>1||a.shiftKey||a.altKey||a.metaKey)){a.preventDefault();ia(this)}})}return true}return false}if(a.colorbox)return;a(ja);W=a.fn[e]=a[e]=function(b,c){var f=this;b=b||{};ja();if(ka()){if(!f[0]){if(f.selector)return f;f=a("<a/>");b.open=true}if(c)b.onComplete=c;f.each(function(){a.data(this,e,a.extend({},a.data(this,e)||d,b))}).addClass(g);if(a.isFunction(b.open)&&b.open.call(f)||b.open)ia(f[0])}return f};W.position=function(a,b){var c,d=0,e=0,g=r.offset(),h,i;z.unbind("resize."+f);r.css({top:-9e4,left:-9e4});h=z.scrollTop();i=z.scrollLeft();if(K.fixed&&!o){g.top-=h;g.left-=i;r.css({position:"fixed"})}else{d=h;e=i;r.css({position:"absolute"})}if(K.right!==false)e+=Math.max(da()-K.w-O-M-ba(K.right,"x"),0);else if(K.left!==false)e+=ba(K.left,"x");else e+=Math.round(Math.max(da()-K.w-O-M,0)/2);if(K.bottom!==false)d+=Math.max(ea()-K.h-N-L-ba(K.bottom,"y"),0);else if(K.top!==false)d+=ba(K.top,"y");else d+=Math.round(Math.max(ea()-K.h-N-L,0)/2);r.css({top:g.top,left:g.left});a=r.width()===K.w+O&&r.height()===K.h+N?0:a||0;s[0].style.width=s[0].style.height="9999px";function j(a){u[0].style.width=x[0].style.width=t[0].style.width=a.style.width;t[0].style.height=v[0].style.height=w[0].style.height=a.style.height}c={width:K.w+O,height:K.h+N,top:d,left:e};if(a===0)r.css(c);r.dequeue().animate(c,{duration:a,complete:function(){j(this);T=false;s[0].style.width=K.w+O+M+"px";s[0].style.height=K.h+N+L+"px";if(K.reposition)setTimeout(function(){z.bind("resize."+f,W.position)},1);if(b)b()},step:function(){j(this)}})};W.resize=function(a){if(S){a=a||{};if(a.width)K.w=ba(a.width,"x")-O-M;if(a.innerWidth)K.w=ba(a.innerWidth,"x");A.css({width:K.w});if(a.height)K.h=ba(a.height,"y")-N-L;if(a.innerHeight)K.h=ba(a.innerHeight,"y");if(!a.innerHeight&&!a.height){A.css({height:"auto"});K.h=A.height()}A.css({height:K.h});W.position(K.transition==="none"?0:K.speed)}};W.prep=function(b){if(!S)return;var c,d=K.transition==="none"?0:K.speed;A.remove();A=Z(X,"LoadedContent").append(b);function g(){K.w=K.w||A.width();K.w=K.mw&&K.mw<K.w?K.mw:K.w;return K.w}function h(){K.h=K.h||A.height();K.h=K.mh&&K.mh<K.h?K.mh:K.h;return K.h}A.hide().appendTo(B.show()).css({width:g(),overflow:K.scrolling?"auto":"hidden"}).css({height:h()}).prependTo(t);B.hide();a(R).css({float:"none"});if(o)a("select").not(r.find("select")).filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one(k,function(){this.style.visibility="inherit"});c=function(){var b,c,g=y.length,h,i="frameBorder",k="allowTransparency",l,o,p,q;if(!S)return;function s(){if(n)r[0].style.removeAttribute("filter")}l=function(){clearTimeout(V);C.detach().hide();ga(j,K.onComplete)};D.html(K.title).add(A).show();if(g>1){if(typeof K.current==="string")E.html(K.current.replace("{current}",Q+1).replace("{total}",g)).show();G.html(K.next).addClass("cboxNext").show();H.html(K.previous).addClass("cboxPrevious").show();if(K.loop||Q<g-1){G.attr("title",K.ntitle).addClass("cboxNextHover").css({cursor:"pointer",opacity:""});$leftnav.show()}else{G.removeAttr("title").removeClass("cboxNextHover").css({cursor:"default",opacity:".45"});$leftnav.hide()}if(K.loop||Q){H.attr("title",K.ptitle).addClass("cboxPrevHover").css({cursor:"pointer",opacity:""});$rightnav.show()}else{H.removeAttr("title").removeClass("cboxPrevHover").css({cursor:"default",opacity:".45"});$rightnav.hide()}$leftnav.css("height",A.height()-90+"px").attr("title",K.ntitle);$rightnav.css("height",A.height()-90+"px").attr("title",K.ptitle);if(K.slideshow)F.show();if(K.preloading){b=[aa(-1),aa(1)];while(c=y[b.pop()]){q=a.data(c,e);if(q&&q.href){o=q.href;if(a.isFunction(o))o=o.call(c)}else o=c.href;if(ca(o)){p=new Image;p.src=o}}}}else J.hide();if(K.iframe){h=Z("iframe")[0];if(i in h)h[i]=0;if(k in h)h[k]="true";h.name=f+ +new Date;if(K.fastIframe)l();else a(h).one("load",l);h.src=K.href;if(!K.scrolling)h.scrolling="no";a(h).addClass(f+"Iframe").appendTo(A).one(m,function(){h.src="//about:blank"})}else l();if(K.transition==="fade")r.fadeTo(d,1,s);else s()};if(K.transition==="fade")r.fadeTo(d,0,function(){W.position(0,c)});else W.position(d,c)};W.load=function(b){var c,d,e=W.prep;T=true;R=false;P=y[Q];if(!b)fa();ga(m);ga(i,K.onLoad);K.h=K.height?ba(K.height,"y")-N-L:K.innerHeight&&ba(K.innerHeight,"y");K.w=K.width?ba(K.width,"x")-O-M:K.innerWidth&&ba(K.innerWidth,"x");K.mw=K.w;K.mh=K.h;if(K.maxWidth){K.mw=ba(K.maxWidth,"x")-O-M;K.mw=K.w&&K.w<K.mw?K.w:K.mw}if(K.maxHeight){K.mh=ba(K.maxHeight,"y")-N-L;K.mh=K.h&&K.h<K.mh?K.h:K.mh}c=K.href;V=setTimeout(function(){C.show().appendTo(t)},100);if(K.inline){Z(X).hide().insertBefore(a(c)[0]).one(m,function(){a(this).replaceWith(A.children())});e(a(c))}else if(K.iframe)e(" ");else if(K.html)e(K.html);else if(ca(c)){a(R=new Image).addClass(f+"Photo").error(function(){K.title=false;e(Z(X,"Error").html(K.imgError))}).load(function(){var a;R.onload=null;if(K.scalePhotos){d=function(){R.height-=R.height*a;R.width-=R.width*a};if(K.mw&&R.width>K.mw){a=(R.width-K.mw)/R.width;d()}if(K.mh&&R.height>K.mh){a=(R.height-K.mh)/R.height;d()}}if(K.h)R.style.marginTop=Math.max(K.h-R.height,0)/2+"px";if(n)R.style.msInterpolationMode="bicubic";setTimeout(function(){e(R)},1)});setTimeout(function(){R.src=c},1)}else if(c)B.load(c,K.data,function(b,c,d){e(c==="error"?Z(X,"Error").html(K.xhrError):a(this).contents())})};W.next=function(){if(!T&&y[1]&&(K.loop||y[Q+1])){Q=aa(1);W.load()}};W.prev=function(){if(!T&&y[1]&&(K.loop||Q)){Q=aa(-1);W.load()}};W.close=function(){if(S&&!U){U=true;S=false;ga(k,K.onCleanup);z.unbind("."+f+" ."+p);q.fadeTo(200,0);r.stop().fadeTo(300,0,function(){r.add(q).css({opacity:1,cursor:"auto"}).hide();ga(m);A.remove();setTimeout(function(){U=false;ga(l,K.onClosed)},1)})}};W.remove=function(){a([]).add(r).add(q).remove();r=null;a("."+g).removeData(e).removeClass(g).die()};W.element=function(){return a(P)};W.settings=d})(jQuery,document,this);$(document).ready(function(){$("div.floorplan a").colorbox({href:function(){return"/pic/popupshems/"+$(this).attr("href").substring(1)+".jpg"},rel:"plans",title:" "});$("div.buildface a").colorbox({href:function(){return"/pic/popupshems/"+$(this).attr("href").substring(1)+".jpg"},title:function(){return $(this).parent().text().replace(/^\s+/g,'').substring(13)}})})